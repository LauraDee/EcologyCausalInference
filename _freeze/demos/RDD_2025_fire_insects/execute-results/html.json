{
  "hash": "b7fa27b53b4afb72fa25a40af4a6268d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Simulation Study of Sharp and Fuzzy RDD\"\nauthor: \"Your Name\"\ndate: \"2025-03-28\"\noutput: html_document\n---\n\n\n\n\n\n\n## Introduction\nThis simulation study investigates the impact of a forest fire (discontinuity) on insect diversity using distance from the fire edge as the running variable.\n\n## Simulating Data\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(123)\nn <- 500\ndistance <- runif(n, -50, 50)  # Running variable: distance from fire edge\n\ndiversity_control <- 50 + 0.5 * distance + rnorm(n, sd = 5)  # Control group trend\ndiversity_treated <- 30 + 0.3 * distance + rnorm(n, sd = 5)  # Treated group trend\n\ntreatment <- ifelse(distance < 0, 1, 0)  # Treatment assignment at fire edge\ndiversity <- ifelse(treatment == 1, diversity_treated, diversity_control)\n\n# Adding confounders\nvegetation_density <- 80 - 0.6 * distance + rnorm(n, sd = 5)  # Higher closer to fire\nsoil_moisture <- 40 + 0.4 * distance + rnorm(n, sd = 3)  # Lower closer to fire\n\ndata <- data.frame(distance, treatment, diversity, vegetation_density, soil_moisture)\n```\n:::\n\n\n\n\n## Visualizing the Discontinuity\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = distance, y = diversity, color = factor(treatment))) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  theme_minimal() +\n  labs(title = \"Effect of Forest Fire on Insect Diversity\",\n       x = \"Distance from Fire Edge (meters)\",\n       y = \"Insect Diversity Index\",\n       color = \"Treatment\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](RDD_2025_fire_insects_files/figure-html/plot-data-1.png){width=672}\n:::\n:::\n\n\n\n\n## Assessing Covariates as a Function of Distance\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = distance, y = vegetation_density)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"blue\") +\n  theme_minimal() +\n  labs(title = \"Vegetation Density as a Function of Distance\",\n       x = \"Distance from Fire Edge\",\n       y = \"Vegetation Density\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](RDD_2025_fire_insects_files/figure-html/plot-covariates-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data, aes(x = distance, y = soil_moisture)) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE, color = \"green\") +\n  theme_minimal() +\n  labs(title = \"Soil Moisture as a Function of Distance\",\n       x = \"Distance from Fire Edge\",\n       y = \"Soil Moisture\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](RDD_2025_fire_insects_files/figure-html/plot-covariates-2.png){width=672}\n:::\n:::\n\n\n\n\n## Sharp RDD Estimation\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrdd_object <- rdd_data(y = diversity, x = distance, cutpoint = 0, covar = data[, c(\"vegetation_density\", \"soil_moisture\")])\nrdd_result <- rdd_reg_lm(rdd_object)\nsummary(rdd_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ ., data = dat_step1, weights = weights)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-13.9399  -3.1587   0.2082   3.4872  12.5939 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 29.87636    0.59444  50.260  < 2e-16 ***\nD           20.89177    0.88546  23.594  < 2e-16 ***\nx            0.29176    0.02164  13.484  < 2e-16 ***\nx_right      0.19520    0.03106   6.284 7.22e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.87 on 496 degrees of freedom\nMultiple R-squared:  0.9489,\tAdjusted R-squared:  0.9486 \nF-statistic:  3072 on 3 and 496 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n## Fuzzy RDD Simulation (with Imperfect Treatment Assignment)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntreatment_fuzzy <- ifelse(distance < 0, rbinom(n, 1, 0.8), rbinom(n, 1, 0.2))  # Imperfect compliance\ndiversity_fuzzy <- ifelse(treatment_fuzzy == 1, diversity_treated, diversity_control)\n\ndata_fuzzy <- data.frame(distance, treatment_fuzzy, diversity_fuzzy, vegetation_density, soil_moisture)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_fuzzy, aes(x = distance, y = diversity_fuzzy, color = factor(treatment_fuzzy))) +\n  geom_point(alpha = 0.5) +\n  geom_smooth(method = \"lm\", se = FALSE) +\n  theme_minimal() +\n  labs(title = \"Fuzzy RDD: Effect of Fire on Insect Diversity\",\n       x = \"Distance from Fire Edge\",\n       y = \"Insect Diversity Index\",\n       color = \"Observed Treatment\")\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](RDD_2025_fire_insects_files/figure-html/fuzzy-rdd-plot-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrdd_fuzzy_object <- rdd_data(y = diversity_fuzzy, x = distance, cutpoint = 0, covar = c(\"vegetation_density\", \"soil_moisture\"), data = data_fuzzy)\nrdd_fuzzy_result <- rdd_reg_lm(rdd_fuzzy_object, covariates = TRUE)\nsummary(rdd_fuzzy_result)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = y ~ ., data = dat_step1, weights = weights)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-32.661  -4.477   0.739   5.487  28.000 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 33.15522    1.12319  29.519  < 2e-16 ***\nD           12.33450    1.67307   7.372 7.07e-13 ***\nx            0.31123    0.04088   7.612 1.37e-13 ***\nx_right      0.21549    0.05869   3.672 0.000267 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 9.202 on 496 degrees of freedom\nMultiple R-squared:  0.7881,\tAdjusted R-squared:  0.7868 \nF-statistic: 614.9 on 3 and 496 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n:::\n\n\n\n\n## Conclusion\nThis simulation demonstrates the use of Sharp and Fuzzy RDD in evaluating the impact of forest fires on insect diversity. The sharp RDD estimates the direct effect, while the fuzzy RDD accounts for imperfect treatment assignment. Additionally, we assess vegetation density and soil moisture as potential confounders and visualize their relationship with distance from the fire edge.\n",
    "supporting": [
      "RDD_2025_fire_insects_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}